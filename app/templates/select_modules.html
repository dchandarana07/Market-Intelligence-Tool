{% extends "base.html" %}

{% block title %}Select Modules · Market Intelligence{% endblock %}

{% block progress %}
<section class="progress-shell">
    <div class="container">
        <ol class="progress-rail">
            <li class="progress-node completed">
                <span class="node-index">1</span>
                <div>
                    <strong>Start</strong>
                    <span>Topic</span>
                </div>
            </li>
            <li class="progress-node active">
                <span class="node-index">2</span>
                <div>
                    <strong>Select Modules</strong>
                    <span>Scope</span>
                </div>
            </li>
            <li class="progress-node">
                <span class="node-index">3</span>
                <div>
                    <strong>Configure</strong>
                </div>
            </li>
            <li class="progress-node">
                <span class="node-index">4</span>
                <div>
                    <strong>Review</strong>
                </div>
            </li>
            <li class="progress-node">
                <span class="node-index">5</span>
                <div>
                    <strong>Run</strong>
                </div>
            </li>
        </ol>
    </div>
</section>
{% endblock %}

{% block content %}
<div class="page-header">
    <span class="eyebrow">Scope & Sources</span>
    <h1>Select data modules</h1>
    <p class="hero-lede">Build the briefing for <strong>{{ session.topic }}</strong>. Jobs and Courses stay selected by default—you can layer on depth as needed.</p>
</div>

{% if error %}
<div class="alert error" role="alert">{{ error }}</div>
{% endif %}

<form action="/select-modules" method="POST" class="fade-in">
    <div class="module-list">
        {% for module in modules %}
        <label class="module-card {% if not module.available %}unavailable{% endif %}">
            <input
                type="checkbox"
                name="modules"
                value="{{ module.name }}"
                {% if not module.available %}disabled{% endif %}
                {% if module.name in ['jobs', 'courses'] %}checked{% endif %}
            >
            <div class="module-meta">
                <div style="display:flex;justify-content:space-between;align-items:center;gap:14px;">
                    <h3>{{ module.display_name }}</h3>
                    {% if not module.available %}
                    <span class="pill warning">Not configured</span>
                    {% endif %}
                </div>
                <p>{{ module.description }}</p>
                {% if module.availability_message %}
                <div class="module-note">{{ module.availability_message }}</div>
                {% endif %}
            </div>
        </label>
        {% endfor %}
    </div>

    <div class="callout" style="margin-top:28px;">
        <strong>Tip:</strong> Selecting <em>Job Postings</em> unlocks downstream skills enrichment for Skills Trends and Normalization.
    </div>

    <div class="actions">
        <a href="/" class="btn btn-ghost">Back</a>
        <button type="submit" class="btn btn-primary">
            Continue to configuration
        </button>
    </div>
</form>
{% endblock %}
